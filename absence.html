<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Professor Adam Dennett FRGS FAcSS, Professor of Urban Analytics, Bartlett Centre for Advanced Spatial Analysis, University College London - a.dennett@ucl.ac.uk - (adam_dennett?)">

<title>Let’s Talk About Absence</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="absence_files/libs/clipboard/clipboard.min.js"></script>
<script src="absence_files/libs/quarto-html/quarto.js"></script>
<script src="absence_files/libs/quarto-html/popper.min.js"></script>
<script src="absence_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="absence_files/libs/quarto-html/anchor.min.js"></script>
<link href="absence_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="absence_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="absence_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="absence_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="absence_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Let’s Talk About Absence</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Professor Adam Dennett FRGS FAcSS, Professor of Urban Analytics, Bartlett Centre for Advanced Spatial Analysis, University College London - a.dennett@ucl.ac.uk - <span class="citation" data-cites="adam_dennett">(<a href="#ref-adam_dennett" role="doc-biblioref"><strong>adam_dennett?</strong></a>)</span> </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="absenceattendance-and-attainment" class="level2">
<h2 class="anchored" data-anchor-id="absenceattendance-and-attainment">Absence/Attendance and Attainment?</h2>
<p>In this piece I am going to change the focus of the conversation and look at something which has thus far been absent (excuse the pun) from any of the conversations about the school system in Brighton. The issue of absence/attendance and its importance for educational outcomes.</p>
<section id="improving-educational-outcomes" class="level3">
<h3 class="anchored" data-anchor-id="improving-educational-outcomes">Improving Educational Outcomes</h3>
<p>The Council’s premise in the very first slide shown in the engagement exercise back in October, was that Brighton and Hove has a large attainment gap and is failing its most disadvantaged pupils. Now, I have since refuted that claim here - <a href="https://adamdennett.github.io/BH_Schools_2/stain_removal.html" class="uri">https://adamdennett.github.io/BH_Schools_2/stain_removal.html</a> - and shown that Brighton is not performing badly as a city and indeed is above the national median in terms of disadvantaged attainment.</p>
<p>However, it is clear that disadvantage and attainment is still an important topic for the council and is one of the main drivers behind the plans in the consultation. The new proposal documentation (<a href="https://democracy.brighton-hove.gov.uk/mgAi.aspx?ID=102291">supporting documents here</a>) states in 3.7 that the council wants a system that:</p>
<p><em>“delivers children’s outcomes which are good and improving especially for those at risk of disadvantage”</em></p>
<p>and under 3.9 that:</p>
<p><em>“the proposals put forward were designed to include: a) Better equality of outcomes – results not driven by economic advantage. b) Deliver a ‘comprehensive’ offer from our city schools as a more mixed pupil intake creates better outcomes for disadvantaged pupils.”</em></p>
<section id="trick-or-treatment" class="level4">
<h4 class="anchored" data-anchor-id="trick-or-treatment">Trick or Treatment?</h4>
<p>The underpinning assumptions in those statements above are that economic advantage/disadvantage are the main drivers of results in the city and the main remedy is through some kind of economic mixing in intakes. But in much the same way as when we go to the doctor, we expect an accurate diagnosis and corresponding efficatious treatment, we all know that unfortunately, sometimes, neither diagnosis nor treatment are correct.</p>
<p>We know the council’s prescribed treatment has been influenced quite heavily by some of the work of Stephen Gorard (<a href="https://theconversation.com/poorer-pupils-do-worse-at-school-heres-how-to-reduce-the-attainment-gap-205535" class="uri">https://theconversation.com/poorer-pupils-do-worse-at-school-heres-how-to-reduce-the-attainment-gap-205535</a>), but is the diagnosis for the city even correct? Before prescribing a treatment, should we have not carried out a thorough examination of the patient in case a more serious underlying ailment is causing the symptoms?</p>
<p>Without wanting to strain the metaphor further, how do we know for sure that a lack of mixing is indeed the main factor holding back disadvantaged attainment? What if it is not? And if it is not, what is more important? And if there are more important factors, might there be more effective routes to minimising disadvantged educational outcomes that could offer better or faster results, and indeed do so without the levels of disruption currently on the table?</p>
<p>These are very important questions to ask, not least because under the current proposals, one of the experimental ‘treatments’ being prescribed by the council is forced mixing in schools through artificially reducing places in schools for local students and ‘<a href="https://en.wikipedia.org/wiki/Desegregation_busing">busing</a>’ significant numbers of students from some neighbouroods (some by ‘choice’ and some through ‘displacement’ <a href="https://www.parentsupport.group/wp-content/uploads/2024/12/schools_admissions_2026_explainer_v1.0_2024-12-4-final.pdf">- see the PGS explainer here</a>) to schools a long way from their homes. This kind of forced mixing not only has a questionable history and efficacy in other contexts (see <span class="citation" data-cites="rossell1990">(<a href="#ref-rossell1990" role="doc-biblioref">Rossell 1990</a>)</span> and others for the US history - a very different context, but same underlying idea), but has huge negative financial, environmental and social implications for our city (many of which were <a href="https://www.parentsupport.group/deputation-to-brighton-council-cabinet-5th-dec-2024/">raised in the Parent Support Group’s latest deputation at the Labour Cabinet meeting in November</a>) which have thus-far been ignored by those advocating for the proposals.</p>
<p>And as I will show below, it is the case that the treatment currently being prescribed by the council, might even make things much worse - again, at risk of stretching the metaphor too far, this could be akin to the approach of doctors in the Crimean war, attempting treatments with the best of intentions, but with a deadly lack of understanding.</p>
</section>
</section>
<section id="is-there-anything-more-important-than-social-mixing-holding-back-educational-attainment-particularly-for-disadvantaged-pupils" class="level3">
<h3 class="anchored" data-anchor-id="is-there-anything-more-important-than-social-mixing-holding-back-educational-attainment-particularly-for-disadvantaged-pupils">Is there anything more important than social mixing holding back educational attainment, particularly for disadvantaged pupils?</h3>
<p>The short answer is: Yes, yes there is. The longer answer is there are lots of things; from raw income deprivation, requiring SEN support to simply moving schools (see p8 of <span class="citation" data-cites="claymore2023">(<a href="#ref-claymore2023" role="doc-biblioref">Claymore 2023a</a>)</span> to see the relative effects of some of these) which can impact attainment. But there is one factor, over an above everything else, that affects attainment the most: <strong>Absence from School.</strong></p>
</section>
</section>
<section id="absence" class="level2">
<h2 class="anchored" data-anchor-id="absence">Absence</h2>
<p>Now at this point, you’d be forgiven for shouting “<strong><em>well that’s bloody obvious, I could have told you that!</em></strong>” - which makes it all the more surprising that it has barely surfaced in the narrative during this whole Brighton Secondary School Admissions engagement/consultation process.</p>
<p>I genuinely don’t know why it hasn’t, but again the rush to consultation and a general lack of due care and attention in gathering relevant evidence throughout, are probably in the blame line-up - of course assuming that the publicly stated aims actually align with a desire to conduct evidence-based policy.</p>
<section id="the-evidence---the-literature" class="level3">
<h3 class="anchored" data-anchor-id="the-evidence---the-literature">The Evidence - the literature</h3>
<p>I could get all academic and cite a bunch of papers and government reports, at this juncture, which detail the important role that absence/attendance plays in educational outcomes over and above everything else, but we’ve “had enough of experts”, right? . No? Oh OK then. First up a recent <a href="https://www.gov.uk/government/publications/against-the-odds/against-the-odds-achieving-greater-progress-for-secondary-students-facing-socio-economic-disadvantage">report for the Government’s Social Mobility Commission</a>, where <span class="citation" data-cites="riordan2021">(<a href="#ref-riordan2021" role="doc-biblioref">Riordan, Jopling, and Starr 2021a</a>)</span> state:</p>
<p><em>“Our statistical models indicate that the strongest predictive factor of the progress made by pupil premium [disadvantaged] students is the school’s absence rate”</em></p>
<p><em>“schools with lower absence rates have smaller progress gaps; pupil premium students progress more at schools with lower absence rates; This correlation is regardless of whether they begin with low, medium or high rates&nbsp;of&nbsp;absence.”</em></p>
<p><em>“These findings concur with previous research and we share their interpretation too, that this correlation is most likely to be causal. This is because there is an intuitive underlying causal mechanism: students not in school are less likely to learn the school curriculum.”</em></p>
<p>Next, <span class="citation" data-cites="claymore2023a">(<a href="#ref-claymore2023a" role="doc-biblioref">Claymore 2023b</a>)</span> (already citied above) in a paper titled: “<a href="https://www.nfer.ac.uk/publications/being-present-the-power-of-attendance-and-stability-for-disadvantaged-pupils/">Being Present: the Power of Attendance and Stability for Stability for Disadvantaged Pupils</a>” states:</p>
<p><em>“On average, the association between being absent from school and KS4 outcomes is worse for disadvantaged pupils than their more affluent peers”</em></p>
<p><em>“Supporting secondary schools to reduce absence, improve behaviour and support within-secondary phase transfers are all key areas of policy focus to boost outcomes of disadvantaged pupils and reduce group gaps in progress and attainment.”</em></p>
<p><em>“over half of the gap in outcomes between disadvantaged pupils and their more affluent peers is associated with the underlying group differences in absence, exclusion and pupil transfer rates. Improving these underlying factors for disadvantaged pupils should therefore substantially boost outcomes for the group”</em></p>
<p>I could also go on to cite work by the National Governance Association <span class="citation" data-cites="nga2024">(<a href="#ref-nga2024" role="doc-biblioref">NGA 2024</a>)</span> on improving School Attendance, or the Department for Education’s extensive resources on why improving school attendance is important<span class="citation" data-cites="dfe2023">(<a href="#ref-dfe2023" role="doc-biblioref">DfE 2023</a>)</span> <span class="citation" data-cites="dfe2024">(<a href="#ref-dfe2024" role="doc-biblioref">DfE 2024</a>)</span>, but I think you are starting to get the picture. It makes sense, right? If you don’t go to school, it’s harder to learn and achieve.</p>
<p>So the literature clearly says absence is important but:</p>
<ul>
<li><p>Is absence from school important for Brighton and Hove?</p></li>
<li><p>And if it is, is it more or less important than social mixing or concentrations of disadvantage in the city?</p></li>
</ul>
<p>Fortunately, as has been the case throughout this whole engagement/consultation exercise, data and analysis can shed some light and help us answer these questions.</p>
</section>
<section id="the-evidence---the-data" class="level3">
<h3 class="anchored" data-anchor-id="the-evidence---the-data">The Evidence - the data</h3>
<section id="what-is-absence-and-how-is-absence-measured" class="level4">
<h4 class="anchored" data-anchor-id="what-is-absence-and-how-is-absence-measured">What is absence and how is absence measured?</h4>
<p>There are lots of different reasons why students miss school, for example to attend medical appointments, illness, religious observance, study leave etc. these are likely to be counted as valid reasons and ‘authorised’ by schools. Then there are reasons that are ‘unauthorised’ and these might include things like going on holiday, but also apply to students that might have to stay home to care for family members as well as truancy - i.e.&nbsp;intentionally missing school without permission to be absent.</p>
<p>Reasons for truancy or ‘school refusal’ can be complex and vary between different children, and I won’t go into them here (various sources of information elsewhere if you are interested, <a href="https://notfineinschool.co.uk/research">including here</a>), but one of the ways in which longer-term absence is measured is if more than 10% of the sessions in a school year are missed. This is often referred to as ‘<strong>Persistent Absence</strong>’ in the data and this is what we will zoom in on here (rather than other types of authorised or unauthorised absence).</p>
</section>
<section id="data-sources" class="level4">
<h4 class="anchored" data-anchor-id="data-sources">Data Sources</h4>
<p>The Department for Education (DfE) publishes various datasets online which cover things like attainment and absence at both the Local Authority level and at the level of individual schools. We will start with this dataset - <a href="https://explore-education-statistics.service.gov.uk/data-catalogue/data-set/be024b4d-4f91-40e4-8a58-50dc53dcc93f" class="uri">https://explore-education-statistics.service.gov.uk/data-catalogue/data-set/be024b4d-4f91-40e4-8a58-50dc53dcc93f</a> - “Absence by geographic level - autumn and spring terms combined” which allows us to look at absence in secondary schools across all local authorities from 2016 until 2023.</p>
<p><strong>Question: What is the national picture of persistent absence and how does Brighton and Hove compare?</strong></p>
</section>
</section>
<section id="persistent-absence---the-national-picture" class="level3">
<h3 class="anchored" data-anchor-id="persistent-absence---the-national-picture">Persistent Absence - The National Picture</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Figure 1 - Persistent Absence in State Secondary Schools, 2016/17 to 2023/24; All Local Authorities in England. Brighton and Hove and England Overlaid.</em></strong></p>
<p>There are couple of things worth pointing out in the plot above:</p>
<ul>
<li><p>The problem of persistent absence has increased massively since 2016/17, with stark change in the years after the COVID-19 pandemic, where the median persistent absence had been declining and has reduced to about 12% by 2020, but shot up to over 25% after COVID and is still at about 24% in the most recent data for 2023/24.</p></li>
<li><p>At the same time, the variance has increased (meaning the median is less representative of the whole data) - with more Local Authorities having rates of persistent absence well above average, with some having over 1/3 of students missing 10% or more of school.</p></li>
<li><p>For Brighton and Hove this situation is bad. Persistent absence has been above average since 2016/17 and while it had declined to only just above the national average in 2020/21, since the Pandemic, the rates of persistent absence have been well above the national average, in 2023/24 topping out at 28%, 4% above the national average of 24%.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Figure 2 - Persistent Absence in State Secondary Schools, All Local Authorities in England 2023/24. Brighton and Hove, Mean, Interquartile Range and Outliers at 90% and 95% added.</em></strong></p>
<ul>
<li><p>If we look at just 2023/24 (Figure 2 above), we can see that Brighton and Hove is not quite an outlier (above the 90% percentile at 1.65 standard deviations from the mean) in terms of persistent absence, but it is well above the national average and outside the interquartile range (where 50% of local authorities would lie) with a rate of 28.2%.</p></li>
<li><p>This is a slightly wordy statistical way of saying that the persistent absence situation in Brighton and Hove raises interest and is much worse than most other places in the country.</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong><em>Figure 3 - Persistent Absence Over Time, Compared to Regions in England</em></strong></p>
<ul>
<li>If we compare Brighton and Hove with other areas in the county - here I have chosen regions simply because there are fewer of them and they can fit on a single graph relatively tidily - we can see that Persistent Absence is worse in the Local Authority than it is in any other region in the country.</li>
</ul>
</section>
<section id="persistent-absence---the-local-picture" class="level3">
<h3 class="anchored" data-anchor-id="persistent-absence---the-local-picture">Persistent Absence - The Local Picture</h3>
<p><em>All data below are downloaded from - https://www.compare-school-performance.service.gov.uk/</em></p>
<p>So what does persistent absence look like at the school-level in Brighton? Are all schools contributing to the city performing so badly on persistent absence or are there areas where absence is particularly bad? The histogram in Figure 4 below plots the rates of persistent absence for all state secondary schools in England in 2022/23 and overlays the rates the different schools for Brighton and Hove. The black dotted line is the median for England.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Figure 4 - Percentage of Enrolments who are persistently absence (over 10% sessions missed), England (Brighton and Hove Schools overlaid).</p>
<section id="observations" class="level4">
<h4 class="anchored" data-anchor-id="observations">Observations</h4>
<ul>
<li><p>Schools are ordered from lowest to highest left-to-right, so congested lines in the middle can be read from the legend in order.</p></li>
<li><p>The national median for persistent absence in 2022/23 is 26.7% of pupils missing 10% or more of possible sessions. Cardinal Newman, Patcham, Dorothy Stringer and Blatchington Mill are all very close to the national average.</p></li>
<li><p>King’s School and Varndean have better/lower persistent absence rates than average - King’s much lower.</p></li>
<li><p>At the other end of the scale, PACA and Hove Park have noticably above-average/worse persistent absence rates, while Longhill has 42.4% of students persistently absent with BACA an outlier with an incredibly high rate of 51.8% making it one of the worst schools for persistent absence in the country.</p></li>
<li><p>The high, above average, city-levels of persistent absence over time shown at the local authority level, appear to be being driven mainly by students who attend two schools - Longhill and BACA</p></li>
</ul>
</section>
</section>
<section id="disadvantaged-pupils" class="level3">
<h3 class="anchored" data-anchor-id="disadvantaged-pupils">Disadvantaged Pupils</h3>
<p>Data from here - <a href="https://explore-education-statistics.service.gov.uk/find-statistics/key-stage-4-performance/2022-23" class="uri">https://explore-education-statistics.service.gov.uk/find-statistics/key-stage-4-performance/2022-23</a></p>
<p>While we are here, it will be useful to look at the disadvantaged pupil picture in the same way. This is because later on we will compare the effects that both disadvantage and absence have on attainment to see which is more important both nationally and in the city. Figure 5 below plots a similar histogram to that above, but this time for disadvantaged pupils.</p>
<p>Taking the description from the DfE “Pupils are defined as disadvantaged if they are known to have been eligible for free school meals at any point in the past six years (from year 6 to year 11), if they are recorded as having been looked after for at least one day or if they are recorded as having been adopted from care.”</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Figure 5 - Percentage of Pupils Disadvantaged at the end of KS4, England (Brighton and Hove Schools overlaid).</em></p>
<p>Observations</p>
<ul>
<li>The national median for disadvantaged pupils at the end of KS4 is around 24%. Most schools in Brighton have below the national average rates of disadvantage.</li>
<li>PACA (26%) and Longhill (29%) have slightly above the national average rate of disadvantage, but not significantly so.</li>
<li>BACA, on the other hand, has a very high rate of disadvantage, with 45% of pupils being disadvantaged.</li>
</ul>
</section>
</section>
<section id="attainment" class="level2">
<h2 class="anchored" data-anchor-id="attainment">Attainment</h2>
<p>Measuring attainment is tricky. Absolute attainment (number of A*s at GCSE - sorry, I know we don’t have A*s anymore, showing my age, but you know what I mean) is a crude measure as it fails to take any account of the diversity of schools and their cohorts, so for a number of years now the preferred measure of attainment as been to look at the ‘value added’ by schools to their pupils by essentially comparing the levels of attainment of pupils when they leave secondary school after their GCSEs, with the levels of attainment they came in with after Primary School.</p>
<p>The standard measure of ‘value added’ used by the government for the last few years is something called the “Progress 8” score. “The score is calculated for each student by comparing their GCSE (or equivalent) results with the results of peers who achieved a similar level of attainment at the end of primary school” <span class="citation" data-cites="riordan2021a">(<a href="#ref-riordan2021a" role="doc-biblioref">Riordan, Jopling, and Starr 2021b</a>)</span>. This is done across 8 subjects/qualifications (hence the name), with England and Maths given a double weighting. It is a ratio centred on Zero and generally ranges between -1 and +1 for most schools (when aggregated to school level).</p>
<p>Progress 8 has been criticised as a measure for various reasons, including its perceived volatility, however the general conclusions in the literature are, it’s not perfect, but it’s certainly better than the old measure of counting students achieving 5 A*-C grades - various pieces including by <span class="citation" data-cites="prior">(<a href="#ref-prior" role="doc-biblioref">Prior et al., n.d.</a>)</span> and <span class="citation" data-cites="beynon2024">(<a href="#ref-beynon2024" role="doc-biblioref">Beynon 2024</a>)</span> <a href="https://www.bristol.ac.uk/policybristol/policy-briefings/calculating-progess-8/">here</a>, and <a href="https://ffteducationdatalab.org.uk/2024/04/changes-in-schools-progress-8-scores-over-time/">here</a> if you want to follow up. And in an <a href="https://ifs.org.uk/publications/unveiling-school-effectiveness-progress-8-parental-choices-and-closing-achievement-gap">Institute for Fiscal Studies report</a>, <span class="citation" data-cites="britton2023a">(<a href="#ref-britton2023a" role="doc-biblioref">Britton, Clark, and Lee 2023</a>)</span> evaluate the effectiveness of using Progress 8 and also conclude that</p>
<p><em>“controlling for prior attainment alone is sufficient to produce accurate estimates, and we find no compelling evidence to suggest that the government’s current effectiveness measure, Progress 8, is unreliable. Given its relative simplicity, Progress 8 is a usable measure for teachers and schools, leading us to conclude that there is a limited case for reform based on our data.”</em></p>
<p>So we will continue with Progress 8 for now.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Figure 6 - Progress 8 across all schools in England, 2022/23 with Brighton and Hove schools overlaid.</em></p>
<p>Observations</p>
<ul>
<li><p>Note, these are not the latest Progress 8 scores from 2023/24 - these have just been publilshed, but not with useful comparative data for the same year yet, so I’m sticking to 2022/23 for now. However, if you want to look at the latest Progress 8 Scores for Brighton Schools, you can see them <a href="https://www.compare-school-performance.service.gov.uk/schools-by-type?step=default&amp;table=schools&amp;region=846&amp;geographic=la&amp;for=secondary&amp;schooltype=2,1&amp;schoollevel=IsSecondary">here</a>. Of note in 2023/24, however, is the fact that of the schools performing below average, BACA has made a notable improvement from -0.5 to -0.4 in the latest P8 stats. Longhill has declined further from -0.62 to -0.7 and Patcham has declined from -0.21 to -0.45. At the other end of the scale, of those above average, Blatchington Mill has improved from 0.03 to 0.3.</p></li>
<li><p>As Progress 8 scores are relative to a national average, the distribution around the mean of 0 is about as normal as you might get and the distribution of Brighton schools around this mean is also pretty normal with as many schools above as below average.</p></li>
<li><p>Longhill has the worst Progress 8 scores in the City in 2022/23, with BACA performing slightly better at that time, although with BACA improving and Longhill declining in 2024, the gap between these schools has increased.</p></li>
</ul>
</section>
<section id="absence-disadvantage-and-attainment" class="level2">
<h2 class="anchored" data-anchor-id="absence-disadvantage-and-attainment">Absence, Disadvantage and Attainment</h2>
<p>In a deputation to Labour Cabinet on 6th December 2024, Dr Carlie Goldsmith from Class Divide aimed an arrow at ‘apparently sophisticated analysis’ from groups in the city opposed to elements of the council’s proposals.</p>
<p>What I hope to offer below is not particularly sophisticated as hopefully you will be able to see with your own eyes the patterns that the data on Absence, Disadvantage and Attainment reveals and arrive at the same interpretations I have.</p>
<p>Being unsophisticated does not mean that I will assume an understanding of some of the more esoteric mathematical dimensions of this analysis, but I will try to keep it as simple as I can and please email me at the address at the top of this piece if you have any questions or queries.</p>
<p>To begin with, I will start with a simple scatter plot. We probably all drew these by hand in science at some point in school. You may have even had a go at drawing a line of best-fit through the points with a ruler (I remember my teachers getting us to do this). The idea is the line is our best attempt at summarising the pattern shown by the dots in the scatter plot, and can be thought of as the average of all the points.</p>
<p>The plot below in Figure 7 is a scatter plot, with each point representing a school in England. The y-axis (vertical) has the average Progress 8 score at the end of KS4 for that school in 2022/23. In this plot, the x-axis (horizontal) represents the % of enrollments at that school that are persistently absent (over 10% of sessions missed) in the same year.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Figure 7 - Progress 8 vs Persistent Absence across all schools in England, 2022/23</em></p>
<p>Observations</p>
<ul>
<li><p>Looking at the plot and all points together, it should hopefully be clear that on the whole, as the % of enrollments who are persistently absent increases, the value of the Progress 8 score decreases. The more a school has high levels of persistent absence, the lower its Progress 8 score is likely to be. There are, of course, a few weird values (outliers) which don’t follow this trend, but most do.</p></li>
<li><p>The blue line throw the centre of the plot is the line of best-fit. This is drawn by the computer and it does so by trying to minimise the total sum of the squared vertical distances (known as <em>residuals</em>) between each black dot in the plot and the line itself. In doing this it ends up with the sum of the positive (dots above the line) and negative residuals (dots below the line) equalling zero.</p></li>
<li><p>The blue line has two properties that are useful for helping us describe the cloud of points it is representing. - The first is known as the ‘intercept’. This is the value on the y-axis of the blue line as it crosses zero. In our example, it can be thought of as the value of Progress 8 we would expect for a school if it had 0% persistent absence. Our average best-case Progress 8, if you like. In our case, this value would be 1.06. - The second is known as the ‘slope’. This is the change in the value of y (Progress 8) for a one-unit change (1% persistent absence) on the x-axis. In our example, the slope is -0.04. This means that for every additional 1% of students that are persistently absent, on average, the Progress 8 score for that school will reduce by -0.04.</p></li>
<li><p>On the plot above, I have calculated one more useful property of the points which statisticians know as <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination">the <span class="math inline">\(R^2\)</span>.</a> In lay terms, this is a number between 0-1 that represents how good a representation of the points the blue line is. The closer the points hug the line, the closer to 1 the value gets. If all of the black points fell exactly on the line, the <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination"><span class="math inline">\(R^2\)</span></a> = 1. Another way of describing the blue line is it’s a model (a representation) of the black points. The closer to 1 our <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination"><span class="math inline">\(R^2\)</span></a> value is, the better our model is and the more reliable it is at describing the underlying relationship.</p></li>
<li><p>Our blue line (model) has an <a href="https://en.wikipedia.org/wiki/Coefficient_of_determination"><span class="math inline">\(R^2\)</span></a> = 0.47. Another way of thinking about this is to say that 47% of the variation in Progress 8 scores between schools can be explained just by the variation in persistent absence. So almost 50%. In statistical terms, this is a very good model. The relationship between Progress 8 and persistent absence is very strong.</p></li>
<li><p>One note of caution with interpreting relationships like this is often it is easy to confuse correlation (things going up or down together) with causation (x causing y, rather than y causing x). This is something all researchers need to be aware of and careful to identify clear theoretical reasons behind suggested relationships. However, in this particular case, the causal pathways are clear. As <span class="citation" data-cites="riordan2021b">(<a href="#ref-riordan2021b" role="doc-biblioref">Riordan, Jopling, and Starr 2021c</a>)</span> (cited earlier) states: “<em>this correlation [between absence and attainment] is most likely to be causal. This is because there is an intuitive underlying causal mechanism: students not in school are less likely to learn the school curriculum.”</em></p></li>
<li><p>So this simple plot</p></li>
</ul>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Figure 7 - Progress 8 vs Persistent Absence, All Schools in England, 2022/23</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4796396</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>                 GVIF Df GVIF^(1/(2*Df))
PPERSABS10   1.658914  1        1.287989
PTFSM6CLA1A  1.363978  1        1.167895
OFSTEDRATING 1.289714  4        1.032314</code></pre>
</div>
<div class="cell-output-display">
<div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Observations</td>
<td style="text-align: right;">3173 (1102 missing obs. deleted)</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">Dependent variable</td>
<td style="text-align: right;">P8MEA</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Type</td>
<td style="text-align: right;">OLS linear regression</td>
</tr>
</tbody>
</table>
</div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">F(6,3166)</td>
<td style="text-align: right;">681.30</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">R²</td>
<td style="text-align: right;">0.56</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">Adj. R²</td>
<td style="text-align: right;">0.56</td>
</tr>
</tbody>
</table>
</div>
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Est.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">S.E.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t val.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">(Intercept)</td>
<td style="text-align: right;">-0.03</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-4.22</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">PPERSABS10</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-31.66</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">PTFSM6CLA1A</td>
<td style="text-align: right;">-0.05</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">-6.87</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">OFSTEDRATINGOutstanding</td>
<td style="text-align: right;">0.38</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">20.18</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">OFSTEDRATINGRequires improvement</td>
<td style="text-align: right;">-0.25</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">-13.14</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left; font-weight: bold;">OFSTEDRATINGSerious Weaknesses</td>
<td style="text-align: right;">-0.24</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">-4.49</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left; font-weight: bold;">OFSTEDRATINGSpecial Measures</td>
<td style="text-align: right;">-0.36</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">-5.54</td>
<td style="text-align: right;">0.00</td>
</tr>
</tbody><tfoot>
<tr class="even">
<td style="text-align: left; padding: 0;"><sup></sup> Standard errors: OLS; Continuous predictors are mean-centered and scaled by 1 s.d. The outcome variable remains in its original units.</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tfoot>

</table>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_summs</span>(model, <span class="at">inner_ci_level =</span> .<span class="dv">9</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="absence_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>

</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-beynon2024" class="csl-entry" role="listitem">
Beynon, Katie. 2024. <span>“Changes in Schools’ Progress 8 Scores over Time.”</span> <a href="https://ffteducationdatalab.org.uk/2024/04/changes-in-schools-progress-8-scores-over-time/">https://ffteducationdatalab.org.uk/2024/04/changes-in-schools-progress-8-scores-over-time/</a>.
</div>
<div id="ref-britton2023a" class="csl-entry" role="listitem">
Britton, J, D Clark, and I Lee. 2023. <span>“Unveiling School Effectiveness: Progress 8, Parental Choices and Closing the Achievement Gap.”</span> <a href="https://ifs.org.uk/publications/unveiling-school-effectiveness-progress-8-parental-choices-and-closing-achievement-gap">https://ifs.org.uk/publications/unveiling-school-effectiveness-progress-8-parental-choices-and-closing-achievement-gap</a>.
</div>
<div id="ref-claymore2023" class="csl-entry" role="listitem">
Claymore, Zoe. 2023a. <span>“Being Present: The Power of Attendance and Stability for Disadvantaged Pupils.”</span> <a href="https://www.nfer.ac.uk/publications/being-present-the-power-of-attendance-and-stability-for-disadvantaged-pupils/">https://www.nfer.ac.uk/publications/being-present-the-power-of-attendance-and-stability-for-disadvantaged-pupils/</a>.
</div>
<div id="ref-claymore2023a" class="csl-entry" role="listitem">
———. 2023b. <span>“Being Present: The Power of Attendance and Stability for Disadvantaged Pupils.”</span> <a href="https://www.nfer.ac.uk/publications/being-present-the-power-of-attendance-and-stability-for-disadvantaged-pupils/">https://www.nfer.ac.uk/publications/being-present-the-power-of-attendance-and-stability-for-disadvantaged-pupils/</a>.
</div>
<div id="ref-dfe2023" class="csl-entry" role="listitem">
DfE. 2023. <span>“Why Is School Attendance so Important and What Are the Risks of Missing a Day? <span></span> The Education Hub.”</span> <a href="https://educationhub.blog.gov.uk/2023/05/18/school-attendance-important-risks-missing-day/">https://educationhub.blog.gov.uk/2023/05/18/school-attendance-important-risks-missing-day/</a>.
</div>
<div id="ref-dfe2024" class="csl-entry" role="listitem">
———. 2024. <span>“Working Together to Improve School Attendance.”</span> <a href="https://www.gov.uk/government/publications/working-together-to-improve-school-attendance">https://www.gov.uk/government/publications/working-together-to-improve-school-attendance</a>.
</div>
<div id="ref-nga2024" class="csl-entry" role="listitem">
NGA. 2024. <span>“Improving School Attendance | National Governance Association.”</span> <a href="https://www.nga.org.uk/knowledge-centre/improving-school-attendance/">https://www.nga.org.uk/knowledge-centre/improving-school-attendance/</a>.
</div>
<div id="ref-prior" class="csl-entry" role="listitem">
Prior, L, J Jerrim, D Thompson, and G Leckie. n.d. <span>“Is It Worth Calculating Progress 8 Anymore? | PolicyBristol | University of Bristol.”</span> <a href="https://www.bristol.ac.uk/policybristol/policy-briefings/calculating-progess-8/">https://www.bristol.ac.uk/policybristol/policy-briefings/calculating-progess-8/</a>.
</div>
<div id="ref-riordan2021" class="csl-entry" role="listitem">
Riordan, S, M Jopling, and S Starr. 2021a. <span>“Against the Odds: Achieving Greater Progress for Secondary Students Facing Socio-Economic Disadvantage.”</span> <a href="https://www.gov.uk/government/publications/against-the-odds">https://www.gov.uk/government/publications/against-the-odds</a>.
</div>
<div id="ref-riordan2021a" class="csl-entry" role="listitem">
———. 2021b. <span>“Against the Odds: Achieving Greater Progress for Secondary Students Facing Socio-Economic Disadvantage.”</span> <a href="https://www.gov.uk/government/publications/against-the-odds">https://www.gov.uk/government/publications/against-the-odds</a>.
</div>
<div id="ref-riordan2021b" class="csl-entry" role="listitem">
———. 2021c. <span>“Against the Odds: Achieving Greater Progress for Secondary Students Facing Socio-Economic Disadvantage.”</span> <a href="https://www.gov.uk/government/publications/against-the-odds">https://www.gov.uk/government/publications/against-the-odds</a>.
</div>
<div id="ref-rossell1990" class="csl-entry" role="listitem">
Rossell, Christine H. 1990. <em>The Carrot or the Stick for School Desegregation Policy: Magnet Schools or Forced Busing</em>. Temple University Press. <a href="https://www.jstor.org/stable/j.ctt14bt4t1">https://www.jstor.org/stable/j.ctt14bt4t1</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>